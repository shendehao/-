<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯•é¡µé¢</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-8 bg-gray-100">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-2xl font-bold mb-4">ğŸ” å¯¼èˆªè°ƒè¯•é¡µé¢</h1>
        
        <div class="space-y-4">
            <!-- æµ‹è¯•å¯¼èˆªé¡¹ -->
            <div class="border rounded p-4">
                <h2 class="font-bold mb-2">æµ‹è¯•å¯¼èˆªé¡¹</h2>
                <nav>
                    <a href="javascript:void(0);" 
                       data-page="test-page-1" 
                       class="nav-item block p-2 bg-blue-100 mb-2 rounded hover:bg-blue-200">
                        ç‚¹å‡»æˆ‘ - æµ‹è¯•é¡µé¢1
                    </a>
                    <a href="javascript:void(0);" 
                       data-page="test-page-2" 
                       class="nav-item block p-2 bg-green-100 mb-2 rounded hover:bg-green-200">
                        ç‚¹å‡»æˆ‘ - æµ‹è¯•é¡µé¢2
                    </a>
                </nav>
            </div>
            
            <!-- æ—¥å¿—è¾“å‡º -->
            <div class="border rounded p-4">
                <h2 class="font-bold mb-2">ğŸ“‹ äº‹ä»¶æ—¥å¿—</h2>
                <div id="log" class="bg-gray-50 p-3 rounded font-mono text-sm h-64 overflow-auto"></div>
            </div>
            
            <!-- æ£€æŸ¥ç»“æœ -->
            <div class="border rounded p-4">
                <h2 class="font-bold mb-2">âœ… æ£€æŸ¥ç»“æœ</h2>
                <div id="checks" class="space-y-2"></div>
            </div>
        </div>
    </div>

    <!-- APIå®¢æˆ·ç«¯ -->
    <script src="/static/js/api-service.js?v=2"></script>
    
    <!-- åº”ç”¨è„šæœ¬ -->
    <script src="/static/js/app.js?v=2"></script>
    
    <script>
        const logDiv = document.getElementById('log');
        const checksDiv = document.getElementById('checks');
        
        function log(message, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const colors = {
                'info': 'text-blue-600',
                'success': 'text-green-600',
                'error': 'text-red-600',
                'warning': 'text-yellow-600'
            };
            logDiv.innerHTML += `<div class="${colors[type]}">[${time}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function addCheck(label, passed, details = '') {
            const icon = passed ? 'âœ…' : 'âŒ';
            const color = passed ? 'text-green-600' : 'text-red-600';
            checksDiv.innerHTML += `
                <div class="${color}">
                    ${icon} ${label}
                    ${details ? `<span class="text-gray-600 text-sm ml-2">${details}</span>` : ''}
                </div>
            `;
        }
        
        // æ‰§è¡Œæ£€æŸ¥
        log('ğŸš€ å¼€å§‹æ£€æŸ¥...', 'info');
        
        // 1. æ£€æŸ¥APIå¯¹è±¡
        if (typeof API !== 'undefined') {
            addCheck('APIå¯¹è±¡å·²åŠ è½½', true);
            log('âœ… APIå¯¹è±¡å­˜åœ¨', 'success');
        } else {
            addCheck('APIå¯¹è±¡å·²åŠ è½½', false, 'APIå¯¹è±¡æœªå®šä¹‰');
            log('âŒ APIå¯¹è±¡ä¸å­˜åœ¨', 'error');
        }
        
        // 2. æ£€æŸ¥Appå¯¹è±¡
        if (typeof App !== 'undefined') {
            addCheck('Appå¯¹è±¡å·²åŠ è½½', true);
            log('âœ… Appå¯¹è±¡å­˜åœ¨', 'success');
        } else {
            addCheck('Appå¯¹è±¡å·²åŠ è½½', false, 'Appå¯¹è±¡æœªå®šä¹‰');
            log('âŒ Appå¯¹è±¡ä¸å­˜åœ¨', 'error');
        }
        
        // 3. æ£€æŸ¥PageManager
        if (typeof PageManager !== 'undefined') {
            addCheck('PageManagerå·²åŠ è½½', true);
            log('âœ… PageManagerå­˜åœ¨', 'success');
        } else {
            addCheck('PageManagerå·²åŠ è½½', false, 'PageManageræœªå®šä¹‰');
            log('âŒ PageManagerä¸å­˜åœ¨', 'error');
        }
        
        // 4. æ£€æŸ¥å¯¼èˆªé¡¹
        const navItems = document.querySelectorAll('.nav-item');
        addCheck('å¯¼èˆªé¡¹æ•°é‡', navItems.length > 0, `æ‰¾åˆ° ${navItems.length} ä¸ª`);
        log(`ğŸ“Š æ‰¾åˆ° ${navItems.length} ä¸ªå¯¼èˆªé¡¹`, navItems.length > 0 ? 'success' : 'error');
        
        // 5. æ‰‹åŠ¨ç»‘å®šæµ‹è¯•å¯¼èˆª
        log('ğŸ”§ æ‰‹åŠ¨ç»‘å®šæµ‹è¯•å¯¼èˆª...', 'info');
        navItems.forEach((item, index) => {
            const pageId = item.getAttribute('data-page');
            log(`  ç»‘å®šå¯¼èˆª ${index + 1}: ${pageId}`, 'info');
            
            item.addEventListener('click', (e) => {
                e.preventDefault();
                log(`ğŸ–±ï¸ ç‚¹å‡»äº†: ${pageId}`, 'success');
                alert(`å¯¼èˆªç‚¹å‡»æˆåŠŸï¼\né¡µé¢ID: ${pageId}`);
            });
        });
        
        addCheck('äº‹ä»¶ç›‘å¬å™¨å·²ç»‘å®š', true, `${navItems.length} ä¸ªå¯¼èˆªé¡¹`);
        log('âœ… äº‹ä»¶ç›‘å¬å™¨ç»‘å®šå®Œæˆ', 'success');
        
        // 6. æµ‹è¯•ä¸»é¡µé¢çš„å¯¼èˆª
        log('ğŸ” æ£€æŸ¥ä¸»é¡µé¢å¯¼èˆª...', 'info');
        setTimeout(() => {
            const mainNavItems = window.parent.document.querySelectorAll('.nav-item');
            if (mainNavItems.length > 0) {
                addCheck('ä¸»é¡µé¢å¯¼èˆªé¡¹', true, `æ‰¾åˆ° ${mainNavItems.length} ä¸ª`);
                log(`âœ… ä¸»é¡µé¢æœ‰ ${mainNavItems.length} ä¸ªå¯¼èˆªé¡¹`, 'success');
            } else {
                addCheck('ä¸»é¡µé¢å¯¼èˆªé¡¹', false, 'æœªæ‰¾åˆ°');
                log('âŒ ä¸»é¡µé¢æ²¡æœ‰å¯¼èˆªé¡¹', 'error');
            }
        }, 100);
        
        log('âœ¨ æ£€æŸ¥å®Œæˆï¼è¯·ç‚¹å‡»ä¸Šé¢çš„æµ‹è¯•å¯¼èˆªé¡¹', 'success');
    </script>
</body>
</html>
