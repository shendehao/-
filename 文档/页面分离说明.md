# 库存管理系统 - 页面分离架构说明

## 📂 目录结构

```
库存管理系统/
├── main.html                 # 主框架HTML文件（新入口）
├── index.html                # 原单页应用（保留作为备份）
├── templates/                # 页面模板目录
│   ├── dashboard.html        # 仪表盘页面
│   ├── items.html           # 库存物品页面
│   ├── inbound.html         # 入库管理页面
│   ├── outbound.html        # 出库管理页面
│   ├── transfer.html        # 库存调拨页面
│   ├── warehouse.html       # 仓库管理页面
│   ├── supplier.html        # 供应商管理页面
│   ├── reports.html         # 报表分析页面
│   └── settings.html        # 系统设置页面
├── js/                       # JavaScript文件目录
│   ├── page-loader.js       # 页面加载器
│   ├── api-service.js       # API服务层
│   └── ui-handlers.js       # UI事件处理
└── API文档.md               # API接口文档
```

## 🚀 使用方法

### 方式一：使用新的分离架构（推荐）

打开 `main.html` 文件，系统会自动从 `templates/` 目录加载各个页面。

```bash
# 本地运行
python -m http.server 8080
# 然后访问 http://localhost:8080/main.html
```

### 方式二：使用原单页应用

打开 `index.html`，所有页面都集成在一个文件中（之前的版本）。

## 🎯 页面分离的优势

### 1. **更好的维护性**
- ✅ 每个页面独立文件，修改互不影响
- ✅ 代码结构清晰，易于定位问题
- ✅ 团队协作更方便，可以并行开发不同页面

### 2. **提升性能**
- ✅ 按需加载，减少初始加载时间
- ✅ 只加载当前需要的页面内容
- ✅ 降低内存占用

### 3. **便于扩展**
- ✅ 新增页面只需添加HTML文件
- ✅ 在 `page-loader.js` 中注册即可
- ✅ 不影响现有页面

### 4. **代码复用**
- ✅ JavaScript逻辑分离到独立文件
- ✅ API服务层统一管理
- ✅ UI组件可跨页面使用

## 📝 核心文件说明

### main.html
- **作用**: 主框架文件，包含顶部导航、侧边栏、主内容区域
- **特点**: 
  - 提供布局结构
  - 引入所有必需的CSS和JS
  - 包含模态框等全局组件

### page-loader.js
- **作用**: 动态加载页面模板
- **核心功能**:
  ```javascript
  PageLoader.loadPage('dashboard')  // 加载仪表盘
  PageLoader.loadPage('items')      // 加载库存物品页面
  ```
- **工作流程**:
  1. 从 `templates/` 目录获取HTML
  2. 注入到 `#page-content` 容器
  3. 调用页面专属初始化函数
  4. 更新导航高亮状态

### api-service.js
- **作用**: 统一的API请求服务
- **包含**:
  - API配置
  - 通用请求方法
  - 模拟数据（演示模式）
  - 各模块API方法
  - 页面数据加载函数

### ui-handlers.js
- **作用**: UI交互事件处理
- **包含**:
  - 模态框管理
  - 表单验证
  - 交互动画

## 🔧 如何添加新页面

### 步骤1: 创建页面HTML
在 `templates/` 目录创建新文件，例如 `new-page.html`:

```html
<!-- 新页面 -->
<div class="new-page-content">
  <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
    <div>
      <h2 class="text-2xl font-semibold tracking-tight">新页面标题</h2>
      <p class="text-gray-dark mt-1">页面描述</p>
    </div>
  </div>
  
  <!-- 页面内容 -->
  <div class="bg-white rounded-apple shadow-apple p-6">
    <p>这是新页面的内容</p>
  </div>
</div>
```

### 步骤2: 注册页面
在 `js/page-loader.js` 中添加配置:

```javascript
pages: {
  // ... 其他页面
  'new-page': { file: 'new-page.html', nav: 9, loader: 'loadNewPage' }
}
```

### 步骤3: 添加导航链接
在 `main.html` 的侧边栏添加:

```html
<li>
  <a href="javascript:void(0);" class="flex items-center space-x-3 px-3 py-3 rounded-apple-sm text-gray-dark hover:bg-light transition-colors duration-200 group">
    <i class="fas fa-star text-xl w-6 text-center"></i>
    <span class="hidden md:inline">新页面</span>
  </a>
</li>
```

### 步骤4: 创建数据加载函数（可选）
在 `js/api-service.js` 中添加:

```javascript
window.loadNewPage = async function() {
  // 加载页面数据的逻辑
  console.log('新页面已加载');
};
```

## 🎨 设计规范

所有页面遵循统一的 Apple 风格设计：

### 颜色主题
```javascript
primary: '#007AFF'     // 主色调
secondary: '#5AC8FA'   // 次要色
success: '#34C759'     // 成功
warning: '#FF9500'     // 警告
danger: '#FF3B30'      // 危险
```

### 圆角规范
- `rounded-apple`: 12px（大卡片）
- `rounded-apple-sm`: 8px（按钮、小卡片）
- `rounded-full`: 完全圆角（图标、头像）

### 阴影规范
- `shadow-apple`: 默认阴影
- `shadow-apple-hover`: 悬停阴影

### 间距规范
- 页面标题底部: `mb-6`
- 卡片间距: `gap-4` 或 `gap-6`
- 内容内边距: `p-4` 或 `p-6`

## 🔌 API集成

每个页面可以使用全局 `API` 对象：

```javascript
// 获取物品列表
const response = await API.items.list({ page: 1 });

// 创建新物品
await API.items.create(itemData);

// 获取仪表盘统计
const stats = await API.dashboard.getStats();
```

## 📊 页面对应关系

| 导航菜单 | 页面ID | 模板文件 | 数据加载函数 |
|---------|--------|----------|-------------|
| 仪表盘 | dashboard | dashboard.html | initDashboard |
| 库存物品 | items | items.html | loadItemsPage |
| 入库管理 | inbound | inbound.html | loadInboundPage |
| 出库管理 | outbound | outbound.html | loadOutboundPage |
| 库存调拨 | transfer | transfer.html | loadTransferPage |
| 仓库管理 | warehouse | warehouse.html | - |
| 供应商 | supplier | supplier.html | - |
| 报表分析 | reports | reports.html | - |
| 系统设置 | settings | settings.html | - |

## 🐛 常见问题

### Q: 页面加载失败怎么办？
A: 检查以下几点：
1. 确认 `templates/` 目录存在且包含对应的HTML文件
2. 使用本地服务器运行（不要直接打开HTML文件）
3. 查看浏览器控制台的错误信息

### Q: 如何切换回原单页应用？
A: 直接打开 `index.html` 即可使用原版本。

### Q: 模态框无法打开？
A: 确保 `ui-handlers.js` 已正确加载，检查浏览器控制台是否有错误。

### Q: 图表不显示？
A: 确认 ECharts 库已加载，仪表盘页面需要调用 `initDashboardCharts()` 函数。

## 💡 最佳实践

1. **开发时使用分离版本** (`main.html`)
   - 便于调试和修改
   - 代码结构清晰

2. **部署时可选择**:
   - 分离版本：更好的维护性
   - 单页版本：更少的HTTP请求

3. **保持样式一致**:
   - 使用统一的TailwindCSS类名
   - 遵循Apple设计规范

4. **API优先**:
   - 先确保API正常工作
   - 再添加UI交互

## 📞 技术支持

- **API文档**: 参考 `API文档.md`
- **前端使用说明**: 参考 `前端使用说明.md`
- **快速开始**: 参考 `快速开始.md`

---

**版本**: v2.0.0（页面分离版）  
**最后更新**: 2024-12-05  
**作者**: Cascade AI
